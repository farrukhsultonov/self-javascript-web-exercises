<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapbox Exercises</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <style>

        header {
            text-align: center;
        }

        #map {
            width: 100%;
            height: 700px;
        }

        .pizza, .restaurantPopup {
            text-align: center;
        }

    </style>
</head>
<body>
<header>
    <h1>MapBox API</h1>
</header>
<div id="map"></div>
<script src="js/keys.js"></script>
<script src="js/mapbox-geocoder-utils.js"></script>
<script>
    const restaurants = [
        {
            name: "Texas Roadhouse",
            longitude: -96.6386785645222,
            latitude: 32.983899666581344
        },
        {
            name: "McDonald's",
            longitude: -96.8030806476694,
            latitude: 32.77887142354196
        },
        {
            name: "Pizza Hut",
            longitude: -96.77896140164239,
            latitude: 32.80350262247961
        }
    ]


    mapboxgl.accessToken = ACCESS_TOKEN;
    const map = new mapboxgl.Map({
        container: 'map', // container ID
// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/streets-v12', // style URL
        center: [-74.5, 40], // starting position [lng, lat]
        zoom: 10 // starting zoom
    });

    // geocode("308 S Akard St, Dallas, TX 75202", ACCESS_TOKEN).
    //     then(coords => {
    //         console.log(coords);
    //         const pizzaMarker = new mapboxgl.Marker()
    //             .setLngLat(coords)
    //             .addTo(map);
    //         map.setCenter(coords);
    //         map.setZoom(18);
    //         const pizzaPopup = new mapboxgl.Popup().
    //             setHTML(`<h2 class="pizza">Zalat Pizza</h2>`);
    //         pizzaMarker.setPopup(pizzaPopup);
    //
    //     });


    restaurants.forEach((restaurant, index)=> {
        // checks whether the current iteration is the last one in the loop
        if (index === restaurants.length -1){
            map.setCenter([restaurant.longitude, restaurant.latitude]);
            map.setZoom(10);
        }
        const marker = new mapboxgl.Marker()
            .setLngLat([restaurant.longitude, restaurant.latitude])
            .addTo(map);
        const popup = new mapboxgl.Popup()
            .setHTML(`
                <h2 class="restaurant-popup">${restaurant.name}</h2>
            `);
        marker.setPopup(popup);


    })

</script>
</body>
</html>